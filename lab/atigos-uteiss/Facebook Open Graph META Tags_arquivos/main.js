curl(["js!"+z.moo],function(){function e(){var e=n().hash.replace("#",f),t=$$("#"+e+", a[name="+e+"]");return e&&t[h]?t[0]:0}function t(e){var t=n();return e.replace(t.protocol+"//"+t.host,f)}function n(){return a.location}function s(e,t){console.log("Setting window location ",e," :: ",t),a.location=e}function i(e,t,n){var s;return function(){var i=this,a=arguments;clearTimeout(s),s=setTimeout(function(){s=null,n||e.apply(i,a)},t),n&&!s&&e.apply(i,a)}}var a=z.w,o=z.d,r=$(o.body),c=$("main"),l="/page/loaded",u="click",d="value",h="length",f="",m=function(){};z.isDebug&&sessionStorage.clear();var p=function(){var e;return function(){return e||(e=new Element("div",{"class":"device-state offscreen"}).inject(r)),parseInt(e.getStyle("z-index"),10)}}(),g=window.globalAds={reloadAll:function(){this.reloadBSA()},reloadSidebar:function(){this.reloadBSA()},reloadBSA:function(){curl(["js!//s3.buysellads.com/ac/bsa.js"],function(){$$("script[id^=_bsap_js_]").destroy(),$$(".bsa").each(function(e){var t=e.get("data-bsa");if(t){var n=t.split("|");e.innerHTML='<div id="bsap_'+n[0]+'" class="bsarocks bsap_'+n[1]+'"></div>'}}),a._bsap&&_bsap.exec(),console.log("calling _bsap.exec() to refresh ads!")})}},v=function(){var e={},t=e.hasOwnProperty;return{subscribe:function(n,s,i){t.call(e,n)||(e[n]=[]);var a=e[n].push(s)-1;return i&&s({}),{remove:function(){delete e[n][a]}}},publish:function(n,s){t.call(e,n)&&e[n].each(function(e){e(s||{})})}}}();console.log(function(){v.subscribe(l,function(){var e=z.domain;$$("a[href*="+e+"]").each(function(t){t.set("href",t.get("href").replace(e,location.host))})},!0)}()),Class.Binds=new Class({$bound:{},bound:function(e){return this.$bound[e]?this.$bound[e]:this.$bound[e]=this[e].bind(this)}}),Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(e){this.options.log&&winconsole&&console.log&&console.log("JSONP retrieving script with url:"+e)},onError:function(e){this.options.log&&winconsole&&console.warn&&console.warn("JSONP "+e+" will fail in Internet Explorer, which enforces a 2083 bytes length limit on URIs")},url:f,callbackKey:"callback",injectScript:o.head,data:f,link:"ignore",timeout:0,log:!1},initialize:function(e){this.setOptions(e)},send:function(e){if(!Request.prototype.check.call(this,e))return this;this.running=!0;var t=typeOf(e);("string"==t||"element"==t)&&(e={data:e}),e=Object.merge(this.options,e||{});var n=e.data;switch(typeOf(n)){case"element":n=$(n).toQueryString();break;case"object":case"hash":n=Object.toQueryString(n)}var s=this.index=Request.JSONP.counter++,i=e.url+(e.url.test("\\?")?"&":"?")+e.callbackKey+"=Request.JSONP.request_map.request_"+s+(n?"&"+n:f);i[h]>2083&&this.fireEvent("error",i),Request.JSONP.request_map["request_"+s]=function(){this.success(arguments,s)}.bind(this);var a=this.getScript(i).inject(e.injectScript);return this.fireEvent("request",[i,a]),e.timeout&&this.timeout.delay(e.timeout,this),this},getScript:function(e){return this.script||(this.script=new Element("script",{type:"text/javascript",async:!0,src:e})),this.script},success:function(e){this.running&&this.clear().fireEvent("complete",e).fireEvent("success",e).callChain()},cancel:function(){return this.running&&this.clear().fireEvent("cancel"),this},isRunning:function(){return!!this.running},clear:function(){return this.running=!1,this.script&&(this.script.destroy(),this.script=null),this},timeout:function(){return this.running&&(this.running=!1,this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()),this}}),Request.JSONP.counter=0,Request.JSONP.request_map={},function(){function e(e){return/^(?:body|html)$/i.test(e.tagName)}Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:!0},initialize:function(e,t){var n,s;this.element=this.subject=$(e),this.parent(t),"element"!=typeOf(this.element)&&(this.element=$(this.element.getDocument().body)),this.options.wheelStops&&(n=this.element,s=this.cancel.pass(!1,this),this.addEvent("start",function(){n.addEvent("mousewheel",s)},!0),this.addEvent("complete",function(){n.removeEvent("mousewheel",s)},!0))},set:function(){var e=Array.flatten(arguments);return Browser.firefox&&(e=[Math.round(e[0]),Math.round(e[1])]),this.element.scrollTo(e[0],e[1]),this},compute:function(e,t,n){return[0,1].map(function(s){return Fx.compute(e[s],t[s],n)})},start:function(e,t){var n;return this.check(e,t)?(n=this.element.getScroll(),this.parent([n.x,n.y],[e,t])):this},calculateScroll:function(e,t){var n,s=this.element,i=s.getScrollSize(),a=s.getScroll(),o=s.getSize(),r=this.options.offset,c={x:e,y:t};for(n in c)!c[n]&&0!==c[n]&&(c[n]=a[n]),"number"!=typeOf(c[n])&&(c[n]=i[n]-o[n]),c[n]+=r[n];return[c.x,c.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(!1,0))},toLeft:function(){return this.start.apply(this,this.calculateScroll(0,!1))},toRight:function(){return this.start.apply(this,this.calculateScroll("right",!1))},toBottom:function(){return this.start.apply(this,this.calculateScroll(!1,"bottom"))},toElement:function(t,n){var s,i;return n=n?Array.from(n):["x","y"],s=e(this.element)?{x:0,y:0}:this.element.getScroll(),i=Object.map($(t).getPosition(this.element),function(e,t){return n.contains(t)?e+s[t]:!1}),this.start.apply(this,this.calculateScroll(i.x,i.y))},toElementEdge:function(e,t,n){var s,i,a,o,r,c;return t=t?Array.from(t):["x","y"],e=$(e),s={},i=e.getPosition(this.element),a=e.getSize(),o=this.element.getScroll(),r=this.element.getSize(),c={x:i.x+a.x,y:i.y+a.y},["x","y"].each(function(e){t.contains(e)&&(c[e]>o[e]+r[e]&&(s[e]=c[e]-r[e]),i[e]<o[e]&&(s[e]=i[e])),null==s[e]&&(s[e]=o[e]),n&&n[e]&&(s[e]=s[e]+n[e])},this),(s.x!=o.x||s.y!=o.y)&&this.start(s.x,s.y),this},toElementCenter:function(e,t,n){var s,i,a,o,r;return t=t?Array.from(t):["x","y"],e=$(e),s={},i=e.getPosition(this.element),a=e.getSize(),o=this.element.getScroll(),r=this.element.getSize(),["x","y"].each(function(e){t.contains(e)&&(s[e]=i[e]-(r[e]-a[e])/2),null==s[e]&&(s[e]=o[e]),n&&n[e]&&(s[e]=s[e]+n[e])},this),(s.x!=o.x||s.y!=o.y)&&this.start(s.x,s.y),this}})}();var b=function(e){return function(t){e.toElement(t)}}(new Fx.Scroll(a,{onComplete:function(){v.publish("/scroll/complete")}})),y={set:function(e,t){try{sessionStorage.setItem(e,t)}catch(n){}},get:function(e){try{return sessionStorage.getItem(e)}catch(t){}return null}};!function(){function e(e){return e.preventDefault(),"click"==e.type&&o.hasClass(l)?void t(m):(s&&clearTimeout(s),i=setTimeout(function(){n(c[0]),o.addClass(l),d.removeClass(h).addClass(f)},"click"==e.type?0:m),!1)}function t(e){i&&clearTimeout(i),s=setTimeout(function(){o.removeClass(l),d.removeClass(f).addClass(h)},e)}function n(e){o.getElements("."+l).removeClass(l),e.addClass(l),$("nav-"+e.get(r)).addClass(l)}var s,i,a=$$(".logo")[0],o=$("main-nav"),r="data-content",c=o.getElements("a["+r+"]"),l="active",d=$("logo-icon"),h=d.get("class").split(" ")[1],f=d.get("data-open-icon"),m=200;a.addEvents({mouseenter:e,click:e}),c.each(function(e){e.addEvent("mouseenter",function(){n(e)})}),o.addEvent("mouseenter",function(){s&&clearTimeout(s)}),$$(o,a).addEvent("mouseleave",function(){t(m)}).addEvent(u+":relay(a)",function(){i&&clearTimeout(i),o.removeClass(l)})}(),z.loadSidebar&&function(){function e(e){var t=new Element("div",{"class":"sidebar",html:e});c.parentNode.appendChild(t),t.fade(1);var n=p()<3,s="allowfullscreen";n&&new IFrame("iframe",{src:"//www.youtube.com/embed/2zxgeK5utW8?autoplay=0&rel=0&showinfo=0&controls=0",frameborder:0,width:340,height:191,webkitallowfullscreen:"webkit"+s,mozallowfullscreen:"moz"+s,allowfullscreen:s}).inject($("sidebar-oreilly").childNodes[0],"after")}var t="sidebar",n=y.get(t+"-punky");n?(console.log("Pulling sidebar HTML from storage"),e(n),setTimeout(function(){g.reloadSidebar()},1e3)):curl(["text!"+z.themePath+"/"+t+".php?"+(new Date).getTime()],function(n){console.log("Loading sidebar HTML via AJAX"),y.set(t+"-punky",n),e(n),setTimeout(function(){g.reloadSidebar()},1e3)})}();var w=function(){return{trackPageView:function(){a.ga&&ga("send","pageview",location+f),console.log("sending pageview: ",location+f)},trackEvent:function(e,t){var n={hitType:"event",eventCategory:e.category||f,eventAction:e.action||f,eventLabel:e.label||f,eventValue:e.value||0,hitCallback:t||m};a.ga?(console.log("sending event: ",n),ga("send",n)):t&&t()}}}();z.analyticsID&&v.subscribe(l,function(){w.trackPageView()}),location.search&&w.trackEvent({category:"Search",label:location.search.replace("?s=",f)}),curl(["js!libs/prism-build.js"],function(){function e(e){$$(e||"pre, .comments code").each(function(e){if(!(e.get("prism")||e.hasClass("codepen")||e.getParent(".gist"))){var t=e.get("html");if("code"==e.get("tag")){if(-1==t.indexOf("\n"))return;e=new Element("pre").replaces(e),t=t.replace(/<br( \/)?>/g,"")}t=t.replace(/>/g,"&gt;").replace(/</g,"&lt;").trim();var n=e.className||"js",s="language-"+n.toLowerCase();e.set({html:'<code class="'+s+'">'+t+"</code>",prism:1,"class":s}),Prism.highlightElement(e)}})}var t=Prism.languages;t.xml=t.html=t.markup,t.js=t.javascript,t.shell=t.bash,t.sass=t.stylus=t.scss=t.css,v.subscribe(l,function(){e()},!0),v.subscribe("/comments/placed",function(t){e(t.element.getElements("pre, code"))})}),function(){function e(e,t,s){var i=t+s,a=function(t){e.get(n)||t&&"undefined"!=t&&"0"!=t&&new Element("span",{html:t}).inject(e.parentNode)&&e.set(n,1)},o=y.get(i);null!=o?a(o):new Request.JSONP({url:t,callback:"callback",timeout:5e3,onComplete:function(e){var t=e[s];a(t),y.set(i,t)}}).send()}function t(){console.log("getting counts");var t=$$(".meta .get-count");t[h]&&t.each(function(t){{var n=t.getParent("ul"),s=n.get("data-url").replace(location.host,z.domain);n.get("data-title")}t.hasClass("twitter")?e(t,"http://urls.api.twitter.com/1/urls/count.json?url="+s,"count"):t.hasClass("facebook")&&e(t,"https://graph.facebook.com/?id="+s,"shares")})}var n="data-counted";r.addEvent(u+":relay(.social-icons a.soc)",function(e,t){e.stop();var n=t.getParent("ul"),s=n.get("data-url"),i=n.get("data-title"),a=n.get("data-twitter-handle")||"davidwalshblog";t.hasClass("twitter")?open("http://twitter.com/share?url="+s+"&text="+i+" by @"+a,"tshare","height=400,width=550,resizable=1,toolbar=0,menubar=0,status=0,location=0"):t.hasClass("facebook")?open("http://facebook.com/sharer.php?s=100&p[url]="+s+"&p[images][0]="+z.themePath+"/images/open-graph.png&p[title]="+i,"fbshare","height=380,width=660,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0"):t.hasClass("google-plus")&&open("https://plus.google.com/share?url="+s,"gshare","height=270,width=630,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0")}),p()<=2&&function(){console.log("Registering counts!"),v.subscribe(l,function(){console.log("Setting all of the social links and counts due to event:  page/load"),t()},!0)}()}(),function(){var e=!1;v.subscribe(l,function(){var t=function(){a.CodePenEmbed&&CodePenEmbed.init()};$$(".codepen")[h]&&function(){if(e)t();else{var n=o.createElement("script");n.async=!0,n.src="//codepen.io/assets/embed/ei.js",n.onload=t,r.appendChild(n),e=!0}}()},!0)}(),v.subscribe(l,function(){$$(".twitter-tweet")[h]&&curl(["js!//platform.twitter.com/widgets.js"],function(){a.twttr&&twttr.widgets.load()})},!0),function(e,t){e.addEvent(u+":relay(.post-list > li)",function(e,t){var n=$(e.target);if("a"!=n.get("tag")&&!n.getParents("a")[h]){var i=t.get("data-url");if(e.meta||e.control)return e.preventDefault(),a.open(i),!1;History.push&&i.indexOf(location.hostname)>-1?(History.push(i),w.trackEvent({category:"Post List Click",action:i})):s(i,"post-items")}}),v.subscribe(l,function(){e.getElements("img["+t+"]").each(function(e){e.set("src",e.get(t)),e.addEvent("load",function(){e.addClass("loaded")})})},!0)}(c,"data-src"),function(){function e(e){$("comment-form").inject(e)}function t(t){var n=t.get("id").replace("comment-",f),s=function(){this.addClass("loaded"),this.removeEvent("load",s)},i=$("comment");p()<=2&&new Element("img",{src:t.get("data-avatar"),alt:"User avatar",events:{load:s}}).inject(t,"top"),new Element("a",{html:'<i aria-hidden="true" class="fa fa-reply"></i>',href:"javascript:;",events:{click:function(){$("comment_parent").set(d,n),e(t),i.focus()}}}).inject(t.getElement(".comment-controls")),t.getElements("div[data-gist]").each(function(e){new Request.JSONP({url:e.get("data-gist")+".json",callback:"callback",timeout:5e3,onComplete:function(t){e.set("html",t.div),curl(["css!"+t.stylesheet])}}).send()}),t.getElements("div[data-fiddle]").each(function(e){new IFrame({src:e.get("data-fiddle")}).inject(e)})}var n;v.subscribe(l,function(){var e=$("comment-list");e&&e.addClass("avatars").getElements("li[data-avatar]").each(t)},!0),c.addEvent(u+":relay(#launch-editor)",function(){var e=($("launch-editor"),$("comment"));this.addClass("hidden");var t="libs/ace/",s=e;curl(["js!"+t+"consolidated.js"],function(){var e=new Element("div",{id:"ace-box"}).inject(s,"after");s.addClass("hidden");var t=n=ace.edit(e);t.setTheme("ace/theme/dreamweaver");var i=this.aceSession=t.getSession();i.setMode(new require("ace/mode/javascript").Mode()),i.setValue(s.get(d)),i.on("change",function(){s.set(d,t.getSession().getValue())}),setTimeout(function(){t.focus()},1e3)}),w.trackEvent({category:"Comments",action:"ACE code editor requested"})}),c.addEvent("submit:relay(#cForm)",function(e){e.preventDefault();var s=$("cForm");s.disabled||new Request({url:s.action,method:"post",onRequest:function(){console.log("Sending new comment request"),s.disabled=!0},onSuccess:function(e){if(console.log("Comment posted success! ",e),"0"!=e){var i=$("comment_parent"),a=$("comment-list");if(i.get(d)){var o=s.getParent("li"),r=$(o.parentNode);if(r.hasClass("children"))r.insertAdjacentHTML("beforeend",e),a=r;else{var c=new Element("ul",{"class":"children"}).inject(o);c.insertAdjacentHTML("beforeend",e),a=c}}else a.insertAdjacentHTML("beforeend",e);var l=a.lastChild;t(l),v.publish("/comments/placed",{element:l}),$("comment").set(d,f),i.set(d,f),n&&n.setValue(f),$(s.parentNode).inject($("comment-form-holder")),b(l)}},onComplete:function(){console.log("Comment form onComplete"),s.disabled=!1}}).send(s.toQueryString()+"&legit=1")})}(),function(){var e=Element.NativeEvents,t=window.location,n=function(e){return e&&e.match(/^https?:\/\//)&&(e="/"+e.split("/").slice(3).join("/")),e},s=n(t.href),i=window.history,a="pushState"in i,o=a?"popstate":"hashchange";this.History=new new Class({Implements:[Class.Binds,Events],initialize:a?function(){e[o]=2,window.addEvent(o,this.bound("pop"))}:function(){e[o]=1,window.addEvent(o,this.bound("pop")),this.hash=t.hash;var n="onhashchange"in window;n&&(void 0===document.documentMode||document.documentMode>7)||(this.timer=this.check.periodical(200,this))},cleanURL:n,push:a?function(e,t,a){e=n(e),s&&s!=e&&(s=null),i.pushState(a||null,t||null,e),this.onChange(e,a)}:function(e){t.hash=n(e)},replace:a?function(e,t,s){i.replaceState(s||null,t||null,n(e))}:function(e){e=n(e),this.hash="#"+e,this.push(e)},pop:a?function(e){var i=n(t.href);return i==s?void(s=null):void this.onChange(i,e.event.state)}:function(){var e=t.hash;this.hash!=e&&(this.hash=e,this.onChange(n(e.substr(1))))},onChange:function(e,t){this.fireEvent("change",[e,t||{}])},back:function(){i.back()},forward:function(){i.forward()},getPath:function(){return n(a?t.href:t.hash.substr(1))},hasPushState:function(){return a},check:function(){this.hash!=t.hash&&this.pop()}})}.call(this),curl([],function(){function s(){r.addClass(S)}function i(){r.removeClass(S)}function d(t){r.hasClass("demo")&&m();var n=p(t);r.className=n.classes,c.set("html",n.postContent),z.d.title=n.title,$$("link[rel=canonical]").set("href",n.canonical),$$("#masthead-title-text").set("html",n.heading),v.publish(l),b(e()||$("top"))}function m(e){return $$(".demo-iframe").setStyle("display","none").destroy(),void 0!=y&&e&&setTimeout(function(){a.scrollTo(0,y);try{g&&g.focus()}catch(e){}},50),r.removeClass("demo"),!1}function p(e){var s="CONTENT",i="MASTHEAD",a=e.match(/<title>(.*)<\/title>/)[1],o={postContent:e.substring(e.indexOf("<!--"+s+"-->"),e.indexOf("<!--/"+s+"-->")),title:a,heading:(e.substring(e.indexOf("<!--"+i+"-->"),e.indexOf("<!--/"+i+"-->"))||a).replace(/\s(?=[^\s]*$)/g,"&nbsp;")},r=e.match(/body class="([^"]*)"/);o.classes=r&&r[1]?r[1]:f;var c=e.match(/<link rel="canonical" href="(.*)"/),l=n()+f;return o.canonical=c&&c[h]>1?c[1]:l,C[t(l)]=e,o}var g,y,E,C={},S="loading";c.addEvent("click:relay(.demo-closer)",function(e){e.preventDefault()}),p(o.documentElement.innerHTML),r.addEvent(u+":relay(a:not([href=#],[href=javascript:;],[data-noxhr]))",function(e,t){if(g=e.target,y=a.scrollY,!e.meta&&!e.control&&2!=e.event.which&&-1!=t.href.indexOf(location.hostname)){var s=t.href,i=n(),o=i+f;-1==s.indexOf(i.host)||s.split("#")[0]==o.split("#")[0]||t.get("target")||(e.stop(),w.trackEvent({category:"AJAX Link Click",action:s}),(-1!==s.indexOf("/http")||-1!==s.indexOf('"'))&&w.trackEvent({category:"Suspicious History.push URL",action:s,label:t.outerHTML}),History.push(s))}});var x,E,k=new Request({method:"get",timeout:1e4,link:"cancel",onRequest:s,onSuccess:d,evalScripts:!0,onFailure:function(){w.trackEvent({category:"AJAX Page Load Failure",action:this.url,label:location+f})},onComplete:i});console.log("Change event applied"),History.addEvent("change",function(a){console.log("change event: ",a),k.cancel();var o=e();if(z.d.body.hasClass("demo")||!o)if(a=function(){var e=n();return-1==a.indexOf("http")&&(a=e.protocol+"//"+e.host+a),a}(),console.log("The current URL is: ",a),-1!=a.indexOf("/demo/")){if(!x){var c="$$('.demo-iframe').setStyle('display', 'none').destroy();History.back();return false;";x=new Element("div",{"class":"demo-box",html:'<div class="demo-toolbar">                   <span class="intro">Demo for:                     <a href="javascript:;" class="demo-closer" id="demo-title"></a>                   </span>                   <a href="javascript:;" class="green-button demo-closer close data-noxhr" on'+u+'="'+c+'">Close Demo<i class="fa fa-times"></i></a>                 </div><div class="demo-iframe-holder"></div>'}).inject(r)}E=new IFrame({src:a,frameborder:0,"class":"demo-iframe",events:{load:function(){try{E.contentWindow.document.documentElement.className="demo-frame"}catch(e){}}}}).inject(x.getFirst(".demo-iframe-holder")),linkEl=x.getElements(".intro a")[0],E.addClass("fadeIn"),E.src=a+"?";var l=$$("a[href="+a+"]"),f=$$("h1, h2")[0].innerHTML;if(l[h]){var m=l[0].getParent("li");m&&(f=m.getFirst("h2 a").innerHTML)}linkEl.set("html",f),r.addClass("demo")}else C[t(a)]?(s(),i(),d(C[t(a)])):(k.url=a,k.send())})}),function(){var e="fixed",t=i(function(){var t=a.scrollY,n=r.hasClass(e),s=$("single-social");t>200?n||(r.addClass(e),s.inject($("masthead-title-text"),"before")):n&&(r.removeClass(e),$("meta").appendChild(s))},10);v.subscribe(l,function(){a[(r.hasClass("single")?"add":"remove")+"Event"]("scroll",t)},!0),v.subscribe(l,function(){$$("#masthead-title .social-icons").destroy()})}(),v.subscribe(l,function(){g.reloadAll(1)}),function(){function e(e){var n=$("x-secondary");if(n){var i=$$("article");if(i[h]){var a=$(i[0]).getFirst("> p");a&&n.inject(a,"after")}n.removeClass("hidden"),setTimeout(function(){$$(".wufoo").addClass(t+(s?"":" now")),s=!1},e)}}var t="complete",n=$("header-fx"),s=!0;v.subscribe(l,function(){e(0)}),e(1e3),setTimeout(function(){n.addClass(t),setTimeout(function(){n.style.webkitFilter="none"},1e3)},2e3)}()});